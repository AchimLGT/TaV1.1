-- Oyunun Player ve Character objelerine erişim için gerekli değişkenler
local player = game.Players.LocalPlayer
local TextChatService = game:GetService("TextChatService")

-- Humanoid'i dinamik olarak güncelleyen fonksiyon
local function getHumanoid()
    local character = player.Character or player.CharacterAdded:Wait()
    return character:WaitForChild("Humanoid")
end

-- GUI oluşturma
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = player:WaitForChild("PlayerGui")
ScreenGui.Name = "JumperJackGui"

-- Ana çerçeve (Frame) oluşturma ve sürükleme özelliği ekleme
local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 200, 0, 180)
Frame.Position = UDim2.new(0.5, -100, 0.5, -90)
Frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
Frame.BorderSizePixel = 0
Frame.Parent = ScreenGui

-- Sürükleme için yardımcı değişkenler
local dragging = false
local dragInput, dragStart, startPos

Frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = Frame.Position
    end
end)

Frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

Frame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

game:GetService("RunService").RenderStepped:Connect(function()
    if dragging and dragInput then
        local delta = dragInput.Position - dragStart
        Frame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)

-- Bitiş sayısı için TextBox
local EndTextBox = Instance.new("TextBox")
EndTextBox.Size = UDim2.new(0, 150, 0, 30)
EndTextBox.Position = UDim2.new(0.5, -75, 0, 50)
EndTextBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
EndTextBox.TextColor3 = Color3.fromRGB(0, 0, 0)
EndTextBox.PlaceholderText = "Bitiş sayısı (örn: 50)"
EndTextBox.Text = ""
EndTextBox.Parent = Frame

-- Başlangıç sayısı için TextBox
local StartTextBox = Instance.new("TextBox")
StartTextBox.Size = UDim2.new(0, 150, 0, 30)
StartTextBox.Position = UDim2.new(0.5, -75, 0, 20)
StartTextBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
StartTextBox.TextColor3 = Color3.fromRGB(0, 0, 0)
StartTextBox.PlaceholderText = "Başlangıç (opsiyonel, örn: 25)"
StartTextBox.Text = ""
StartTextBox.Parent = Frame

-- Zıpla butonu oluşturma
local StartButton = Instance.new("TextButton")
StartButton.Size = UDim2.new(0, 100, 0, 40)
StartButton.Position = UDim2.new(0.25, -50, 0, 110)
StartButton.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
StartButton.TextColor3 = Color3.fromRGB(255, 255, 255)
StartButton.Text = "Zıpla!"
StartButton.Parent = Frame

-- Durdur/Devam Et butonu oluşturma
local PauseButton = Instance.new("TextButton")
PauseButton.Size = UDim2.new(0, 100, 0, 40)
PauseButton.Position = UDim2.new(0.75, -50, 0, 110)
PauseButton.BackgroundColor3 = Color3.fromRGB(215, 120, 0)
PauseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
PauseButton.Text = "Durdur"
PauseButton.Parent = Frame

-- Sayıları Türkçe olarak yazıya çevirme fonksiyonu
local function numberToText(num)
    local birler = {"", "BİR", "İKİ", "ÜÇ", "DÖRT", "BEŞ", "ALTI", "YEDİ", "SEKİZ", "DOKUZ"}
    local onlar = {"", "ON", "YİRMİ", "OTUZ", "KIRK", "ELLİ", "ALTMIŞ", "YETMİŞ", "SEKSEN", "DOKSAN"}
    
    if num == 0 then return "SIFIR" end
    if num <= 9 then return birler[num + 1] end
    if num == 10 then return "ON" end
    
    local on = math.floor(num / 10)
    local bir = num % 10
    if bir == 0 then
        return onlar[on + 1]
    else
        return onlar[on + 1] .. " " .. birler[bir + 1]
    end
end

-- Mesaj gönderme fonksiyonu
local function sendChatMessage(message)
    if TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then
        local textChannels = TextChatService:WaitForChild("TextChannels", 5)
        if textChannels then
            local textChannel = textChannels:WaitForChild("RBXGeneral", 5)
            if textChannel then
                textChannel:SendAsync(message)
                return
            end
        end
    end
    
    local chatEvent = game:GetService("ReplicatedStorage"):FindFirstChild("DefaultChatSystemChatEvents")
    if chatEvent and chatEvent:FindFirstChild("SayMessageRequest") then
        chatEvent.SayMessageRequest:FireServer(message, "All")
        return
    end
    
    print("Chat sistemi kullanılamıyor, mesaj yerel olarak yazdırıldı: " .. message)
end

-- Durum kontrol değişkenleri
local isPaused = false
local isRunning = false
local currentIndex = 1
local targetNumber = 0

-- Zıplama döngüsünü kontrol eden fonksiyon
local function jumpLoop(startNum, endNum)
    for i = startNum, endNum do
        if not isRunning then break end
        while isPaused do
            wait(0.1) -- Durdurulduğunda bekle
        end
        local humanoid = getHumanoid() -- Her adımda güncel humanoid al
        local message = numberToText(i)
        sendChatMessage(message)
        if humanoid and humanoid.Health > 0 then
            humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
        end
        local charCount = utf8.len(message)
        local waitTime = 0.5 + (charCount * 0.25)
        wait(waitTime)
        currentIndex = i + 1
    end
    if not isPaused then
        isRunning = false
        currentIndex = 1
        PauseButton.Text = "Durdur"
    end
end

-- Durdur/Devam Et butonu mantığı
PauseButton.MouseButton1Click:Connect(function()
    if isRunning then
        if isPaused then
            isPaused = false
            PauseButton.Text = "Durdur"
        else
            isPaused = true
            PauseButton.Text = "Devam Et"
        end
    end
end)

-- Zıpla butonu mantığı
StartButton.MouseButton1Click:Connect(function()
    local endInput = tonumber(EndTextBox.Text)
    local startInput = tonumber(StartTextBox.Text) or 1 -- Varsayılan olarak 1
    
    if endInput and endInput > 0 then
        if startInput >= endInput then
            EndTextBox.Text = "Bitiş sayısı başlangıçtan büyük olmalı!"
            wait(1)
            EndTextBox.Text = ""
            return
        end
        
        -- Her zaman sıfırdan başlaması için durumu sıfırla
        isRunning = true
        isPaused = false
        targetNumber = endInput
        currentIndex = startInput -- Her zaman başlangıç sayısına sıfırlanır
        PauseButton.Text = "Durdur"
        
        -- Mevcut döngüyü durdur ve yenisini başlat
        if isRunning then
            isRunning = false -- Önceki döngüyü sonlandır
            wait(0.1) -- Kısa bir bekleme, önceki döngünün tamamen durmasını sağlar
        end
        isRunning = true
        spawn(function() jumpLoop(startInput, endInput) end) -- Yeni döngü başlat
    elseif not endInput or endInput <= 0 then
        EndTextBox.Text = "Lütfen geçerli bir bitiş sayısı gir!"
        wait(1)
        EndTextBox.Text = ""
    end
end)

-- GUI'nin üstünde bir başlık ekleyelim
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(0, 200, 0, 20)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Text = "Jumper Jack"
Title.Parent = Frame

-- Karakter yeniden doğduğunda humanoid'i güncelle
player.CharacterAdded:Connect(function(character)
    -- getHumanoid() zaten dinamik olarak güncel alıyor
end)
